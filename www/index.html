<html>
<head>

<title>Thornton Audio</title>

<script type="text/javascript" src="/jquery-3.3.1.min.js"></script>

<script type="text/javascript">

    function getStatus()
    {
        getChannel();
        getVolume();
    }

    function setChannel(channel)
    {
        $.ajax({
            type:'get',
            url:'cgi-bin/channel?set=' + channel,
            success: function(data) { eval(data); updateChannelHTML(); }
        });
    }

    function getChannel()
    {
        $.ajax({
            type:'get',
            url:'cgi-bin/channel',
            success: function(data) { eval(data); updateChannelHTML(); }
        });
    }

    function updateScreen()
    {
        setTimeout(getStatus, 50);
    }

    function updateChannelHTML()
    {
        current_channel = document.getElementById("current_channel");
        if(channel == -1)
            current_channel.innerHTML = "Select a channel";
        else
            current_channel.innerHTML = "Playing from " + getChannelName(channel);

        // setTimeout(getChannel, 5000);
    }

    function getChannelName(channel)
    {
        switch(channel)
        {
        case 0: return "Radio";
        case 1: return "Cassette Deck";
        case 2: return "Phonograph";
        case 3: return "Multi Disc";
        case 4: return "AudioRx";
        }
    }

    function setVolume(speaker, volumeDelta)
    {
        cmd = volumeDelta == '-1' ? 'dec' : 'inc';
        cmd += speaker;

        $.ajax({
            type:'get',
            url:'cgi-bin/volume?' + cmd,
            success: function(data) { eval(data); updateVolumeHTML(); }
        });
    }

    function setVolumeAll(volumeDelta)
    {
        if(volumeDelta == '-1')
          dir = 'dec';
        else
          dir = 'inc';

        $.ajax({
          type:'get',
          url:'cgi-bin/volume?' + dir,
          success: function(data) { eval(data); updateVolumeHTML(); }
        });
    }

    function getVolume()
    {
        $.ajax({
            type:'get',
            url:'cgi-bin/volume',
            success: function(data) { eval(data); updateVolumeHTML(); }
        });
    }

    function updateVolume()
    {
        vol0 = document.getElementById("volume0").value;
        vol1 = document.getElementById("volume1").value;
        vol2 = document.getElementById("volume2").value;

        $.ajax({
          type:'get',
          url:'cgi-bin/volume?volume0=' + vol0 + '&volume1=' + vol1 + '&volume2=' + vol2,
          success: function(data) { eval(data); updateVolumeHTML(); }
        });
    }

    function updateVolumeHTML()
    {
        document.getElementById("volume0").value = volume_0;
        document.getElementById("volume1").value = volume_1;
        document.getElementById("volume2").value = volume_2;
    }

</script>

<style>
  button.ch { width: 100%; height: 50px; font-size: 100%; }
  button.vol { width: 100%; height: 50px; font-size: 100%; }
  button.volall { width: 100%; height: 150px; font-size: 100%; }
  th#current_channel { font-size: 30px; }

input[type="range"] {
    margin: auto;
    -webkit-appearance: none;
    position: relative;
    overflow: hidden;
    height: 50px;
    width: 100%;
    cursor: pointer;
    border-radius: 0; /* iOS */
}

::-webkit-slider-runnable-track {
    background: blue;
}

::-webkit-slider-thumb {
    -webkit-appearance: none;
    width: 30px;
    height: 50px;
    background: #fff;
    box-shadow: -100vw 0 0 100vw blue;
    border: 2px solid #999; /* 1 */
}
</style>

</head>
<body onload="getStatus()">

  <table width=100%>
    <tr>
      <th id="current_channel" colspan=6>Playing from Channel 1</th>
    </tr>
    <tr>
      <td><button class="ch" onclick="setChannel(-1);">Off</button></td>
      <td><button class="ch" onclick="setChannel(0);">Radio</button></td>
      <td><button class="ch" onclick="setChannel(1);">Cassette Deck</button></td>
    </tr>
    <tr>
      <td><button class="ch" onclick="setChannel(2);">Phonograph</button></td>
      <td><button class="ch" onclick="setChannel(3);">Multi Disc</button></td>
      <td><button class="ch" onclick="setChannel(4);">AudioRx</button></td>
    </tr>
  </table>

  <br/>

  <table width=100%>
  <tr>
    <td width=10% rowspan=3><button class="volall" onclick="setVolumeAll(-1);">-</button></td>
    <td width=10%><button class="vol" onclick="setVolume(0, -1);">-</button></td>
    <td><input type="range" id="volume0" value="0" min=0 max=100 onchange="updateVolume()"></td>
    <td width=10%><button class="vol" onclick="setVolume(0, +1);">+</button></td>
    <td width=10% rowspan=3><button class="volall" onclick="setVolumeAll(+1);">+</button></td>
  </tr>
  <tr>
    <td width=10%><button class="vol" onclick="setVolume(1, -1);">-</button></td>
    <td><input type="range" id="volume1" value="0" min=0 max=100 onchange="updateVolume()"></td>
    <td width=10%><button class="vol" onclick="setVolume(1, +1);">+</button></td>
  </tr>
  <tr>
    <td width=10%><button class="vol" onclick="setVolume(2, -1);">-</button></td>
    <td><input type="range" id="volume2" value="0" min=0 max=100 onchange="updateVolume()"></td>
    <td width=10%><button class="vol" onclick="setVolume(2, +1);">+</button></td>
  </tr>
  </table>


  <br/>

  <div id=player></div>

</body>
</html>
